<div class="flex min-h-screen bg-gray-100">
  <!-- Backdrop (mobile only) -->
  @if (sidebarOpen()) {
    <div
      (click)="toggleSidebar()"
      (keydown.escape)="toggleSidebar()"
      role="button"
      tabindex="-1"
      class="fixed inset-0 z-20 bg-black/50 lg:hidden"
    ></div>
  }

  <!-- Sidebar -->
  <aside
    class="fixed inset-y-0 left-0 z-30 flex w-64 flex-col bg-white shadow-sm transition-transform duration-200"
    [class]="{
      '-translate-x-full': !sidebarOpen(),
      'translate-x-0': sidebarOpen(),
    }"
  >
    <div class="flex items-center justify-between px-6 py-6">
      <h1 class="text-xl font-bold text-gray-900">News App</h1>
      <button
        (click)="toggleSidebar()"
        class="cursor-pointer rounded-lg p-1 text-gray-400 hover:bg-gray-100 hover:text-gray-600"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5"
          viewBox="0 0 20 20"
          fill="currentColor"
        >
          <path
            fill-rule="evenodd"
            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
            clip-rule="evenodd"
          />
        </svg>
      </button>
    </div>

    <nav class="flex-1 space-y-1 px-3">
      <a
        routerLink="/dashboard"
        routerLinkActive="bg-blue-50 text-blue-700"
        [routerLinkActiveOptions]="{ exact: true }"
        (click)="sidebarOpen.set(false)"
        class="flex items-center rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100"
      >
        Dashboard
      </a>
      @if (isAdmin()) {
        <a
          routerLink="/news/create"
          routerLinkActive="bg-blue-50 text-blue-700"
          (click)="sidebarOpen.set(false)"
          class="flex items-center rounded-lg px-3 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100"
        >
          Create News
        </a>
      }
    </nav>

    <div class="border-t border-gray-200 px-6 py-4">
      @if (user()) {
        <p class="text-sm font-medium text-gray-900">{{ user()!.name }}</p>
        <p class="text-xs text-gray-500">{{ user()!.email }}</p>
      }
      <button appButton variant="danger" class="mt-3 w-full" (click)="onLogout()">Logout</button>
    </div>
  </aside>

  <!-- Main content -->
  <main class="flex-1 p-8" [class]="sidebarOpen() ? 'lg:ml-64' : ''">
    <!-- Toggle button -->
    <button
      (click)="toggleSidebar()"
      class="mb-4 cursor-pointer rounded-lg bg-white p-2 shadow-sm hover:bg-gray-50"
      [class.invisible]="sidebarOpen()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5 text-gray-600"
        viewBox="0 0 20 20"
        fill="currentColor"
      >
        <path
          fill-rule="evenodd"
          d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
          clip-rule="evenodd"
        />
      </svg>
    </button>
    <router-outlet />
  </main>
</div>
